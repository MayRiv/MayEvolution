using Nemerle;
using Nemerle.Collections;
using Nemerle.Text;
using Nemerle.Utility;

using System;
using System.Collections.Generic;
using System.Linq;
using System.Timers;
namespace MayEvolutionModels
{
  /// <summary>
  /// Description of MEPresenter.
  /// </summary>
  public class MEPresenter
  {
      view:IView;
      mutable entities:list[Entity];
      mutable timer:Timer;
      public this(view:IView)
      {
         this.view = view;
         entities = Forest(0.5f,0.7f)::Human(0.1f, 0.3f, 10, 0.1f, 10, 0.3f, 0.3f)::[];
         view.TryReDraw += Run;
         
      }
      
      public Run(_:object,_:EventArgs):void
      {
         
          foreach(entity in entities)
          {
               _ = entity.ChangeState();
          }
          Map.Instance.Entities = entities;
          
          view.Clear();
          foreach(entity in entities)
              view.Draw(entity);
          
      }
  }
}
